-- ==== CONFIG ====
local toggleTabletMode       = (_G.toggleTabletMode ~= nil) and _G.toggleTabletMode or false
local togglePhoneMode        = (_G.togglePhoneMode ~= nil) and _G.togglePhoneMode or false
local toggleRejoinIfLoading  = (_G.toggleRejoinIfLoading ~= nil) and _G.toggleRejoinIfLoading or false
local toggleRejoinOnError    = (_G.toggleRejoinOnError ~= nil) and _G.toggleRejoinOnError or false
local toggleKaitun           = (_G.toggleKaitun ~= nil) and _G.toggleKaitun or false

-- SERVICES
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local GuiService = game:GetService("GuiService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- WAIT FULL GAME
local function waitInGame()
    if not game:IsLoaded() then game.Loaded:Wait() end
    while playerGui:FindFirstChild("Loading") do task.wait(0.3) end
    while playerGui:FindFirstChild("DeviceSelect") do task.wait(0.3) end
    task.wait(2)
end

-- AUTO PHONE
if togglePhoneMode then
    task.spawn(function()
        while task.wait(0.2) do
            local d = playerGui:FindFirstChild("DeviceSelect")
            local b = d and d.Container and d.Container.Phone and d.Container.Phone.Button
            if b and b.Visible then firesignal(b.MouseButton1Click) end
        end
    end)
end

-- AUTO TABLET
if toggleTabletMode then
    task.spawn(function()
        while task.wait(0.2) do
            local d = playerGui:FindFirstChild("DeviceSelect")
            local b = d and d.Container and d.Container.Tablet and d.Container.Tablet.Button
            if b and b.Visible then firesignal(b.MouseButton1Click) end
        end
    end)
end

-- REJOIN LOADING
if toggleRejoinIfLoading then
    task.spawn(function()
        local l = playerGui:WaitForChild("Loading", 10)
        if not l then return end
        task.delay(60, function()
            if l.Parent then TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, player) end
        end)
    end)
end

-- REJOIN ERROR
if toggleRejoinOnError then
    GuiService.ErrorMessageChanged:Connect(function(m)
        if m and m ~= "" then TeleportService:Teleport(game.PlaceId, player) end
    end)
end

-- AUTO PLAY
if toggleKaitun then
    task.spawn(function()
        while task.wait(0.3) do
            for _,v in ipairs(playerGui:GetDescendants()) do
                if v:IsA("TextButton") and v.Visible and (v.Text=="Ch∆°i" or v.Text=="Play") then
                    if not v:GetAttribute("AutoClicked") then
                        v:SetAttribute("AutoClicked", true)
                        firesignal(v.MouseButton1Click)
                    end
                end
            end
        end
    end)
end

-- KAITUN
if toggleKaitun then
    waitInGame()

    script_key = "ctpNJSmIRRXxOUiCFKjoWPfXuNznciCe"
    getgenv().Config = {
        HUDHopMinGain = 85,
        HUDHopWindowSec = 600,
        FPSCap = 11,
        Mode = "battlepass",
        Webhook = "https://discord.com/api/webhooks/1240444719230619728/BVoeodXRTpTA7P4vjw822AHLdQnQqdMIRTqtr5Q4idWHGEMxeQB_63KclgBhfs4slDJk",
        DiscordID = "882156430797459456"
    }
    loadstring(game:HttpGet("https://api.luarmor.net/files/v3/loaders/fbdaaeddcf4c27445764a37ba601f35a.lua"))()
end
